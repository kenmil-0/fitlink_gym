# üöÄ Render Deployment Guide for Fitlink Laravel Backend

## üìã Prerequisites
- GitHub repository with your code
- Render account (free tier available)
- Laravel backend in `/backend` folder

## üîß Files Prepared for Deployment

### 1. Root Directory Files
- ‚úÖ `render.yaml` - Render configuration file
- ‚úÖ `RENDER_DEPLOYMENT_GUIDE.md` - This guide
- ‚úÖ `.render-buildpacks.json` - PHP buildpack configuration
- ‚úÖ `composer.json` - Root-level PHP project configuration

### 2. Backend Directory Files
- ‚úÖ `backend/.env.example` - Environment variables template
- ‚úÖ `backend/build.sh` - Build script for Render
- ‚úÖ `backend/public/index.php` - Laravel entry point (no changes needed)
- ‚úÖ `backend/routes/api.php` - API routes with test endpoint

## üöÄ Deployment Steps

### Step 1: Push to GitHub
```bash
git add .
git commit -m "Fix Render PHP detection and deployment configuration"
git push origin main
```

### Step 2: Create Render Account
1. Go to [render.com](https://render.com)
2. Sign up with GitHub
3. Verify your email

### Step 3: Deploy on Render

#### Option A: Using render.yaml (Recommended)
1. **Connect Repository**
   - Click "New +" ‚Üí "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml`

2. **Review Configuration**
   - Service name: `fitlink-api`
   - Root directory: `backend`
   - Environment: PHP
   - Build command: `composer install --no-dev --optimize-autoloader && php artisan key:generate --force && php artisan migrate --force && php artisan config:cache && php artisan route:cache && php artisan view:cache`
   - Start command: `php artisan serve --host 0.0.0.0 --port $PORT`

3. **Add Database**
   - Render will automatically create a MySQL database
   - Database name: `fitlink-db`
   - Environment variables will be automatically linked

4. **Deploy**
   - Click "Apply" to start deployment
   - Wait for build to complete (5-10 minutes)

#### Option B: Manual Setup
1. **Create Web Service**
   - Click "New +" ‚Üí "Web Service"
   - Connect your GitHub repository

2. **Configure Service**
   - **Name**: `fitlink-api`
   - **Root Directory**: `backend`
   - **Environment**: `PHP`
   - **Build Command**: `composer install --no-dev --optimize-autoloader && php artisan key:generate --force && php artisan migrate --force && php artisan config:cache && php artisan route:cache && php artisan view:cache`
   - **Start Command**: `php artisan serve --host 0.0.0.0 --port $PORT`

3. **Add Environment Variables**
   ```
   APP_ENV=production
   APP_DEBUG=false
   APP_KEY= (will be auto-generated)
   APP_URL=https://your-app-name.onrender.com
   DB_CONNECTION=mysql
   CACHE_DRIVER=file
   SESSION_DRIVER=file
   QUEUE_CONNECTION=sync
   LOG_CHANNEL=stack
   BROADCAST_DRIVER=log
   FILESYSTEM_DISK=local
   ```

4. **Add Database**
   - Click "New +" ‚Üí "PostgreSQL" or "MySQL"
   - Name: `fitlink-db`
   - Plan: Free
   - Add database environment variables to your web service

## üß™ Testing the Deployment

### 1. Test API Endpoint
```bash
curl https://your-app-name.onrender.com/api/v1/test
```

Expected response:
```json
{
  "message": "Fitlink API is working!",
  "timestamp": "2025-08-28T...",
  "status": "success",
  "version": "1.0.0"
}
```

### 2. Test Database Connection
```bash
curl https://your-app-name.onrender.com/api/v1/auth/register
```

### 3. Update Mobile App
Update your mobile app's API configuration:
```typescript
// In fitlink-app/src/utils/api.ts
const API_BASE_URL = 'https://your-app-name.onrender.com/api/v1';
```

## üîß Environment Variables

### Required Variables (Auto-configured)
- `APP_KEY` - Auto-generated by Render
- `DB_HOST` - From database service
- `DB_PORT` - From database service
- `DB_DATABASE` - From database service
- `DB_USERNAME` - From database service
- `DB_PASSWORD` - From database service

### Optional Variables (Add manually)
- `MAIL_MAILER` - For email functionality
- `MAIL_HOST` - SMTP server
- `MAIL_USERNAME` - SMTP username
- `MAIL_PASSWORD` - SMTP password
- `PUSHER_APP_ID` - For real-time features
- `PUSHER_APP_KEY` - For real-time features
- `PUSHER_APP_SECRET` - For real-time features

## üêõ Troubleshooting

### Common Issues

1. **PHP Not Found Error**
   - **Problem**: `bash: line 1: php: command not found`
   - **Solution**: Ensure `.render-buildpacks.json` is in root directory
   - **Solution**: Ensure `composer.json` is in root directory
   - **Solution**: Verify `rootDir: backend` in render.yaml

2. **Build Fails**
   - Check build logs in Render dashboard
   - Ensure all dependencies are in `composer.json`
   - Verify PHP version compatibility

3. **Database Connection Error**
   - Verify database environment variables
   - Check database service is running
   - Ensure migrations can run

4. **500 Internal Server Error**
   - Check application logs in Render dashboard
   - Verify `.env` variables are set correctly
   - Ensure storage permissions are correct

5. **CORS Issues**
   - Add CORS middleware to Laravel
   - Configure allowed origins in your app

### Debug Commands
```bash
# Check build logs
# View in Render dashboard

# Check application logs
# View in Render dashboard

# Test database connection
curl https://your-app-name.onrender.com/api/v1/test
```

## üì± Mobile App Integration

### Update API Configuration
1. **Open** `fitlink-app/src/utils/api.ts`
2. **Replace** the API_BASE_URL:
   ```typescript
   const API_BASE_URL = 'https://your-app-name.onrender.com/api/v1';
   ```
3. **Test** the connection in your mobile app

### Test Mobile App
1. **Start** your mobile app development server
2. **Test** API connection from login screen
3. **Try** registering/logging in to verify full functionality

## üéØ Success Checklist

- [ ] Repository pushed to GitHub
- [ ] Render service created and deployed
- [ ] Database connected and migrations run
- [ ] API test endpoint responds correctly
- [ ] Mobile app updated with new API URL
- [ ] Full authentication flow tested
- [ ] All API endpoints working

## üîó Useful Links

- [Render Documentation](https://render.com/docs)
- [Laravel Documentation](https://laravel.com/docs)
- [Laravel Sanctum](https://laravel.com/docs/sanctum)
- [Your API Documentation](https://your-app-name.onrender.com/api/v1/test)

## üìû Support

If you encounter issues:
1. Check Render build logs
2. Check Render application logs
3. Verify environment variables
4. Test API endpoints manually
5. Check Laravel error logs

Your Fitlink API should now be live on Render! üéâ
